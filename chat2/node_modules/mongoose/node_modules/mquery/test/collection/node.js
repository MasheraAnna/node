
var assert = require('assert')
var slice = require('sliced')
var mongo = require('mongodb')
var utils = require('../../').utils;

var uri = process.env.MQUERY_URI || 'mongodb://localhost/mquery';
var db;

exports.getCollection = function (cb) {
<<<<<<< HEAD
  mongo.MongoClient.connect(uri, function (err, db_) {
=======
  mongo.Db.connect(uri, function (err, db_) {
>>>>>>> ddd04dd4029780e3c741876bfe958f3b6a6b5217
    assert.ifError(err);
    db = db_;

    var collection = db.collection('stuff');
<<<<<<< HEAD
=======
    collection.opts.safe = true;
>>>>>>> ddd04dd4029780e3c741876bfe958f3b6a6b5217

    // clean test db before starting
    db.dropDatabase(function () {
      cb(null, collection);
    });
  })
}

exports.dropCollection = function (cb) {
  db.dropDatabase(function () {
    db.close(cb);
  })
}
